package com.cool1024.server.file

import com.cool1024.server.command.Command
import org.apache.pdfbox.pdmodel.PDDocument
import org.apache.pdfbox.rendering.PDFRenderer
import org.springframework.util.Base64Utils
import org.springframework.util.DigestUtils
import java.io.*
import javax.imageio.ImageIO

class PreviewFile(private val fileItem: FileItem) {

    var width = 100
    var height = 100
    val tempPath = "temp"

    init {
        val dir = File(tempPath)
        if (!dir.exists()) {
            dir.mkdir()
        } else if (!dir.isDirectory) {
            dir.delete()
            dir.mkdir()
        }
    }

    fun calculateSize() {
        when (fileItem.fileType) {
            FileType.IMAGE -> execImageSize()
            FileType.VIDEO -> execVideoSize()
            FileType.PDF -> {
                val thumbPath = createPdfThumb()
                val imageBuffer = ImageIO.read(File(thumbPath))
                width = imageBuffer.width
                height = imageBuffer.height
            }
            else -> {

            }
        }
    }

    private fun execImageSize() {
        val formatName = fileItem.fileName.split(".").last()
        println(formatName)
        try {
            val imageReader = ImageIO.getImageReadersByFormatName("jpg").next()
            imageReader.input = ImageIO.createImageInputStream(File(fileItem.path))
            width = imageReader.getWidth(0)
            height = imageReader.getHeight(0)
        } catch (e: Exception) {
            try {
                val imageReader = ImageIO.getImageReadersByFormatName("png").next()
                imageReader.input = ImageIO.createImageInputStream(File(fileItem.path))
                width = imageReader.getWidth(0)
                height = imageReader.getHeight(0)
            }catch (e:Exception) {

            }
        }
    }

    private fun execVideoSize() {
        val processBuilder = ProcessBuilder(
            "ffprobe",
            "-v",
            "quiet",
            "-select_streams",
            "v",
            "-show_entries",
            "stream=width,height",
            fileItem.path
        )
        val process = processBuilder.start()
        val reader = BufferedReader(InputStreamReader(process.inputStream))
        var line: String?
        while (reader.readLine().also { line = it } != null) {
            line?.run {
                if (indexOf("width=") >= 0) {
                    width = substring(6).toInt()
                }
                if (indexOf("height=") >= 0) {
                    height = substring(7).toInt()
                }
            }
        }
        process.waitFor()
        reader.close()
        process.destroy()
    }

    private fun generateTempFile(): String {
        return File(tempPath, DigestUtils.md5DigestAsHex(fileItem.path.toByteArray()) + ".jpeg").absolutePath
    }

    private fun execVideoThumb(): String {
        val tmpFile = generateTempFile()
        if (File(tmpFile).exists()) {
            return tmpFile
        }
        Command.exec(
            "ffmpeg",
            "-i",
            fileItem.path,
            "-ss",
            "00:00:01.000",
            "-vframes",
            "1",
            tmpFile
        )
        return tmpFile
    }

    private fun createPdfThumb(): String {
        val tempFilePath = generateTempFile()
        val tempFile = File(tempFilePath)
        if (tempFile.exists()) {
            return tempFilePath
        }
        val document = PDDocument.load(File(fileItem.path))
        val render = PDFRenderer(document)
        val image = render.renderImage(0)
        ImageIO.write(image, "JPEG", tempFile)
        document.close()
        return tempFilePath
    }

    private fun createDefaultThumb(): String {
        val file = File(tempPath, fileItem.fileType.name + ".svg")
        if (!file.exists()) {
            val svgStr = when (fileItem.fileType) {
                FileType.MUSIC -> MUSIC_SVG
                FileType.DOCS -> DOCS_SVG
                FileType.ZIP -> ZIP_SVG
                FileType.TEXT -> TEXT_SVG
                FileType.EXCEL -> EXCEL_SVG
                FileType.DIR -> DIR_SVG
                else -> OTHER_SVG
            }
            file.writeBytes(Base64Utils.decode(svgStr.toByteArray()))
        }
        return file.absolutePath
    }

    fun previewPath(): String {
        return when (fileItem.fileType) {
            FileType.IMAGE -> fileItem.path
            FileType.VIDEO -> execVideoThumb()
            FileType.PDF -> createPdfThumb()
            else -> createDefaultThumb()
        }
    }

    companion object {
        const val OTHER_SVG =
            "PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQ2MzM2NTkwMjUxIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwNDkiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNzU4LjA5MDMyMyAzNi4zMzU0ODRMNzM2LjYxOTM1NSAxNC44NjQ1MTZoLTU0NS4wMzIyNThjLTQ2LjI0NTE2MSAwLTgyLjU4MDY0NSAzNi4zMzU0ODQtODIuNTgwNjQ1IDgyLjU4MDY0NXY4MjUuODA2NDUyYzAgNDYuMjQ1MTYxIDM2LjMzNTQ4NCA4Mi41ODA2NDUgODIuNTgwNjQ1IDgyLjU4MDY0NWg2NDQuMTI5MDMyYzQ2LjI0NTE2MSAwIDgyLjU4MDY0NS0zNi4zMzU0ODQgODIuNTgwNjQ1LTgyLjU4MDY0NVYyMDEuNDk2Nzc0bC0xNjAuMjA2NDUxLTE2NS4xNjEyOXpNNTMxLjgxOTM1NSA3MTUuMTQ4Mzg3Yy02LjYwNjQ1MiA2LjYwNjQ1Mi0xNi41MTYxMjkgMTEuNTYxMjktMjYuNDI1ODA3IDExLjU2MTI5LTExLjU2MTI5IDAtMTkuODE5MzU1LTMuMzAzMjI2LTI4LjA3NzQxOS0xMS41NjEyOS02LjYwNjQ1Mi02LjYwNjQ1Mi0xMS41NjEyOS0xNi41MTYxMjktMTEuNTYxMjktMjYuNDI1ODA2IDAtMTEuNTYxMjkgMy4zMDMyMjYtMTkuODE5MzU1IDExLjU2MTI5LTI2LjQyNTgwNyA2LjYwNjQ1Mi02LjYwNjQ1MiAxNi41MTYxMjktMTEuNTYxMjkgMjguMDc3NDE5LTExLjU2MTI5czE5LjgxOTM1NSAzLjMwMzIyNiAyNi40MjU4MDcgMTEuNTYxMjljNi42MDY0NTIgNi42MDY0NTIgMTEuNTYxMjkgMTYuNTE2MTI5IDExLjU2MTI5IDI2LjQyNTgwNyAwIDkuOTA5Njc3LTQuOTU0ODM5IDE4LjE2Nzc0Mi0xMS41NjEyOSAyNi40MjU4MDZ6IG04Ny41MzU0ODQtMjcyLjUxNjEyOWMtNC45NTQ4MzkgMTMuMjEyOTAzLTE2LjUxNjEyOSAyOC4wNzc0MTktMzMuMDMyMjU4IDQyLjk0MTkzNi0xMS41NjEyOSA5LjkwOTY3Ny0xOS44MTkzNTUgMTkuODE5MzU1LTI2LjQyNTgwNyAyNi40MjU4MDYtNi42MDY0NTIgOC4yNTgwNjUtMTEuNTYxMjkgMTQuODY0NTE2LTE0Ljg2NDUxNiAyMS40NzA5NjgtMy4zMDMyMjYgNi42MDY0NTItNC45NTQ4MzkgMTEuNTYxMjktNi42MDY0NTIgMTguMTY3NzQyLTEuNjUxNjEzIDYuNjA2NDUyLTEuNjUxNjEzIDEzLjIxMjkwMy0xLjY1MTYxMiAxOS44MTkzNTUgMCAxMS41NjEyOS0zLjMwMzIyNiAxOS44MTkzNTUtOS45MDk2NzggMjQuNzc0MTkzLTYuNjA2NDUyIDQuOTU0ODM5LTE0Ljg2NDUxNiA4LjI1ODA2NS0yNC43NzQxOTMgOC4yNTgwNjVzLTE4LjE2Nzc0Mi0zLjMwMzIyNi0yNC43NzQxOTQtOC4yNTgwNjVjLTYuNjA2NDUyLTQuOTU0ODM5LTkuOTA5Njc3LTEzLjIxMjkwMy05LjkwOTY3Ny0yNC43NzQxOTMgMC02LjYwNjQ1MiAxLjY1MTYxMy0xMy4yMTI5MDMgMy4zMDMyMjUtMjEuNDcwOTY4czYuNjA2NDUyLTE4LjE2Nzc0MiA5LjkwOTY3OC0yOC4wNzc0MmM0Ljk1NDgzOS05LjkwOTY3NyA5LjkwOTY3Ny0xOS44MTkzNTUgMTYuNTE2MTI5LTI5LjcyOTAzMnMxNC44NjQ1MTYtMTkuODE5MzU1IDIzLjEyMjU4MS0yOC4wNzc0MTljNi42MDY0NTItNi42MDY0NTIgMTMuMjEyOTAzLTEzLjIxMjkwMyAxNi41MTYxMjktMTguMTY3NzQyczguMjU4MDY1LTExLjU2MTI5IDExLjU2MTI5LTE2LjUxNjEyOWMzLjMwMzIyNi00Ljk1NDgzOSA0Ljk1NDgzOS05LjkwOTY3NyA0Ljk1NDgzOS0xNC44NjQ1MTYgMS42NTE2MTMtNC45NTQ4MzkgMS42NTE2MTMtMTEuNTYxMjkgMS42NTE2MTItMTYuNTE2MTI5IDAtMTQuODY0NTE2LTQuOTU0ODM5LTI2LjQyNTgwNi0xMy4yMTI5MDMtMzEuMzgwNjQ1LTguMjU4MDY1LTQuOTU0ODM5LTE4LjE2Nzc0Mi04LjI1ODA2NS0zMS4zODA2NDUtOC4yNTgwNjUtMTEuNTYxMjkgMC0yMy4xMjI1ODEgMy4zMDMyMjYtMzEuMzgwNjQ1IDYuNjA2NDUyLTkuOTA5Njc3IDQuOTU0ODM5LTE0Ljg2NDUxNiAxMS41NjEyOS0xNC44NjQ1MTYgMjEuNDcwOTY3IDAgOS45MDk2NzctNC45NTQ4MzkgMTYuNTE2MTI5LTEzLjIxMjkwMyAyMS40NzA5NjgtOC4yNTgwNjUgNC45NTQ4MzktMTguMTY3NzQyIDYuNjA2NDUyLTI2LjQyNTgwNyA2LjYwNjQ1Mi0xMS41NjEyOSAwLTE5LjgxOTM1NS0zLjMwMzIyNi0yNC43NzQxOTMtOC4yNTgwNjUtNC45NTQ4MzktNC45NTQ4MzktNi42MDY0NTItMTEuNTYxMjktNi42MDY0NTItMjEuNDcwOTY4IDAtMTMuMjEyOTAzIDMuMzAzMjI2LTI0Ljc3NDE5NCA5LjkwOTY3Ny0zNi4zMzU0ODMgNi42MDY0NTItMTEuNTYxMjkgMTQuODY0NTE2LTE5LjgxOTM1NSAyNC43NzQxOTQtMjguMDc3NDJzMjMuMTIyNTgxLTE0Ljg2NDUxNiAzNy45ODcwOTctMTguMTY3NzQyYzE0Ljg2NDUxNi00Ljk1NDgzOSAyOS43MjkwMzItNi42MDY0NTIgNDYuMjQ1MTYxLTguMjU4MDY0IDE2LjUxNjEyOSAwIDMxLjM4MDY0NSAxLjY1MTYxMyA0NC41OTM1NDggNi42MDY0NTEgMTMuMjEyOTAzIDQuOTU0ODM5IDI2LjQyNTgwNiAxMS41NjEyOSAzNi4zMzU0ODQgMTkuODE5MzU1IDkuOTA5Njc3IDguMjU4MDY1IDE4LjE2Nzc0MiAxOS44MTkzNTUgMjMuMTIyNTgxIDMzLjAzMjI1OCA0Ljk1NDgzOSAxMy4yMTI5MDMgOC4yNTgwNjUgMjguMDc3NDE5IDguMjU4MDY0IDQ2LjI0NTE2MiAzLjMwMzIyNiAxNC44NjQ1MTYgMS42NTE2MTMgMjkuNzI5MDMyLTQuOTU0ODM4IDQyLjk0MTkzNXoiIGZpbGw9IiNEQ0RDREMiIHAtaWQ9IjEwNTAiPjwvcGF0aD48cGF0aCBkPSJNNzM2LjYxOTM1NSAxNC44NjQ1MTZoLTMuMzAzMjI2djEzMi4xMjkwMzJjMCAxNi41MTYxMjkgOC4yNTgwNjUgNTIuODUxNjEzIDU3LjgwNjQ1MiA1Mi44NTE2MTNoMTI3LjE3NDE5M0w3MzYuNjE5MzU1IDE0Ljg2NDUxNnoiIGZpbGw9IiNFRUVFRUUiIHAtaWQ9IjEwNTEiPjwvcGF0aD48L3N2Zz4="
        const val MUSIC_SVG =
            "PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQ2MzIwNzMxNDA2IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjExNjciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNzQzLjIyNTgwNiAxNC44NjQ1MTZIMTk4LjE5MzU0OGMtNDYuMjQ1MTYxIDAtODIuNTgwNjQ1IDM2LjMzNTQ4NC04Mi41ODA2NDUgODIuNTgwNjQ1djgyNS44MDY0NTJjMCA0Ni4yNDUxNjEgMzYuMzM1NDg0IDgyLjU4MDY0NSA4Mi41ODA2NDUgODIuNTgwNjQ1aDY0NC4xMjkwMzNjNDYuMjQ1MTYxIDAgODIuNTgwNjQ1LTM2LjMzNTQ4NCA4Mi41ODA2NDUtODIuNTgwNjQ1VjE5OS44NDUxNjFMNzQzLjIyNTgwNiAxNC44NjQ1MTZ6IG0tMTMuMjEyOTAzIDQ1MC44OTAzMjNjLTEuNjUxNjEzIDguMjU4MDY1LTQuOTU0ODM5IDE0Ljg2NDUxNi04LjI1ODA2NCAxOS44MTkzNTUtMy4zMDMyMjYgNC45NTQ4MzktNi42MDY0NTIgOC4yNTgwNjUtOS45MDk2NzggNi42MDY0NTEtMy4zMDMyMjYgMC00Ljk1NDgzOS0yMS40NzA5NjgtNi42MDY0NTEtMjQuNzc0MTkzLTEuNjUxNjEzLTMuMzAzMjI2LTMuMzAzMjI2LTguMjU4MDY1LTQuOTU0ODM5LTE4LjE2Nzc0Mi0xLjY1MTYxMy0xMy4yMTI5MDMtNi42MDY0NTItMjQuNzc0MTk0LTE0Ljg2NDUxNi0yOS43MjkwMzMtOC4yNTgwNjUtNi42MDY0NTItMTkuODE5MzU1LTExLjU2MTI5LTM0LjY4Mzg3MS0xNC44NjQ1MTYtMTYuNTE2MTI5LTMuMzAzMjI2LTMxLjM4MDY0NS05LjkwOTY3Ny00NC41OTM1NDktMTkuODE5MzU1LTEzLjIxMjkwMy05LjkwOTY3Ny0yOC4wNzc0MTktMTguMTY3NzQyLTM2LjMzNTQ4My0yOC4wNzc0MTktOC4yNTgwNjUtOC4yNTgwNjUtMTQuODY0NTE2LTkuOTA5Njc3LTE4LjE2Nzc0Mi04LjI1ODA2NC00Ljk1NDgzOSAxLjY1MTYxMy02LjYwNjQ1MiA2LjYwNjQ1Mi02LjYwNjQ1MiAxMS41NjEyOXYzMDcuMmMwIDguMjU4MDY1LTEuNjUxNjEzIDE4LjE2Nzc0Mi00Ljk1NDgzOSAyOC4wNzc0MTktMy4zMDMyMjYgOS45MDk2NzctNC45NTQ4MzkgMTkuODE5MzU1LTEzLjIxMjkwMyAyOS43MjkwMzMtOC4yNTgwNjUgOS45MDk2NzctMTkuODE5MzU1IDE2LjUxNjEyOS0zNC42ODM4NzEgMjMuMTIyNTgtMTQuODY0NTE2IDYuNjA2NDUyLTMzLjAzMjI1OCA5LjkwOTY3Ny01Mi44NTE2MTMgMTEuNTYxMjktMjEuNDcwOTY4IDEuNjUxNjEzLTQxLjI5MDMyMy0zLjMwMzIyNi01OS40NTgwNjQtMTEuNTYxMjktMTguMTY3NzQyLTguMjU4MDY1LTMxLjM4MDY0NS0xOS44MTkzNTUtNDEuMjkwMzIzLTMxLjM4MDY0NS05LjkwOTY3Ny0xMy4yMTI5MDMtMTQuODY0NTE2LTI2LjQyNTgwNi0xNC44NjQ1MTYtNDIuOTQxOTM1IDAtMTQuODY0NTE2IDYuNjA2NDUyLTI5LjcyOTAzMiAyMS40NzA5NjgtNDIuOTQxOTM2IDEzLjIxMjkwMy0xMy4yMTI5MDMgMjguMDc3NDE5LTIzLjEyMjU4MSA0NC41OTM1NDgtMjguMDc3NDE5IDE2LjUxNjEyOS00Ljk1NDgzOSAzMS4zODA2NDUtOC4yNTgwNjUgNDYuMjQ1MTYxLTguMjU4MDY1IDE0Ljg2NDUxNiAwIDM3Ljk4NzA5NyAwIDQ5LjU0ODM4OCAzLjMwMzIyNiAxMS41NjEyOSAzLjMwMzIyNiAxOS44MTkzNTUgNC45NTQ4MzkgMjYuNDI1ODA2IDYuNjA2NDUydi0xNTAuMjk2Nzc1LTE0Mi4wMzg3MDljMC05LjkwOTY3NyAzLjMwMzIyNi0xOC4xNjc3NDIgOC4yNTgwNjUtMjQuNzc0MTk0IDQuOTU0ODM5LTYuNjA2NDUyIDEzLjIxMjkwMy05LjkwOTY3NyAyMS40NzA5NjctMTEuNTYxMjkgOC4yNTgwNjUtMS42NTE2MTMgMTQuODY0NTE2IDAgMTkuODE5MzU1IDQuOTU0ODM5IDQuOTU0ODM5IDMuMzAzMjI2IDAgOS45MDk2NzcgNi42MDY0NTIgMTYuNTE2MTI5IDQuOTU0ODM5IDYuNjA2NDUyIDExLjU2MTI5IDE0Ljg2NDUxNiAxOS44MTkzNTUgMjQuNzc0MTkzczE4LjE2Nzc0MiAxOC4xNjc3NDIgMzEuMzgwNjQ1IDI2LjQyNTgwN2MxMS41NjEyOSA4LjI1ODA2NSAyMS40NzA5NjggMTMuMjEyOTAzIDI5LjcyOTAzMiAxOC4xNjc3NDIgOC4yNTgwNjUgMy4zMDMyMjYgMTYuNTE2MTI5IDYuNjA2NDUyIDIzLjEyMjU4MSA5LjkwOTY3NyA2LjYwNjQ1MiAzLjMwMzIyNiAxNC44NjQ1MTYgNi42MDY0NTIgMjEuNDcwOTY3IDExLjU2MTI5IDYuNjA2NDUyIDQuOTU0ODM5IDE0Ljg2NDUxNiAxMS41NjEyOSAyMy4xMjI1ODEgMjEuNDcwOTY4IDguMjU4MDY1IDkuOTA5Njc3IDEzLjIxMjkwMyAxOC4xNjc3NDIgMTQuODY0NTE2IDI4LjA3NzQxOSAwIDkuOTA5Njc3IDAgMTkuODE5MzU1LTEuNjUxNjEzIDI4LjA3NzQyeiIgZmlsbD0iIzAwQkVDQSIgcC1pZD0iMTE2OCI+PC9wYXRoPjxwYXRoIGQ9Ik03NDMuMjI1ODA2IDE0Ljg2NDUxNmgtMy4zMDMyMjV2MTMyLjEyOTAzMmMwIDE2LjUxNjEyOSA4LjI1ODA2NSA1Mi44NTE2MTMgNTcuODA2NDUxIDUyLjg1MTYxM0g5MjQuOTAzMjI2bC0xMy4yMTI5MDMtMTMuMjEyOTAzTDc0My4yMjU4MDYgMTQuODY0NTE2eiIgZmlsbD0iIzgwREZFNSIgcC1pZD0iMTE2OSI+PC9wYXRoPjwvc3ZnPg=="
        const val DOCS_SVG =
            "PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQ2MzIwNzY1MjA0IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjE0MDEiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNzM5LjkyMjU4MSAyMy4xMjI1ODFsLTYuNjA2NDUyLTYuNjA2NDUyaC01NDUuMDMyMjU4Yy00Ni4yNDUxNjEgMC04Mi41ODA2NDUgMzYuMzM1NDg0LTgyLjU4MDY0NSA4Mi41ODA2NDV2ODI1LjgwNjQ1MmMwIDQ2LjI0NTE2MSAzNi4zMzU0ODQgODIuNTgwNjQ1IDgyLjU4MDY0NSA4Mi41ODA2NDVoNjQ0LjEyOTAzMmM0Ni4yNDUxNjEgMCA4Mi41ODA2NDUtMzYuMzM1NDg0IDgyLjU4MDY0NS04Mi41ODA2NDVWMjAxLjQ5Njc3NEw3MzkuOTIyNTgxIDIzLjEyMjU4MXogbS0xLjY1MTYxMyAzNTguNGMtMy4zMDMyMjYgOS45MDk2NzctNi42MDY0NTIgMTguMTY3NzQyLTguMjU4MDY1IDI2LjQyNTgwNkw2NDQuMTI5MDMyIDY2OC45MDMyMjZjLTMuMzAzMjI2IDkuOTA5Njc3LTguMjU4MDY1IDE2LjUxNjEyOS0xMS41NjEyOSAyMS40NzA5NjgtNC45NTQ4MzkgNC45NTQ4MzktOS45MDk2NzcgNi42MDY0NTItMTguMTY3NzQyIDYuNjA2NDUxLTkuOTA5Njc3IDAtMTYuNTE2MTI5LTMuMzAzMjI2LTIxLjQ3MDk2OC04LjI1ODA2NC00Ljk1NDgzOS00Ljk1NDgzOS04LjI1ODA2NS0xMy4yMTI5MDMtOS45MDk2NzctMjEuNDcwOTY4bC03Mi42NzA5NjgtMjM5LjQ4Mzg3MS02Ni4wNjQ1MTYgMjE2LjM2MTI5Yy00Ljk1NDgzOSAxNC44NjQ1MTYtOS45MDk2NzcgMjguMDc3NDE5LTE0Ljg2NDUxNiAzNy45ODcwOTctNC45NTQ4MzkgOS45MDk2NzctMTEuNTYxMjkgMTQuODY0NTE2LTIzLjEyMjU4MSAxNC44NjQ1MTYtNi42MDY0NTIgMC0xMS41NjEyOS0xLjY1MTYxMy0xNi41MTYxMjktNi42MDY0NTEtNC45NTQ4MzktMy4zMDMyMjYtOC4yNTgwNjUtMTEuNTYxMjktMTMuMjEyOTAzLTIxLjQ3MDk2OGwtODUuODgzODcxLTI2MC45NTQ4MzljLTEuNjUxNjEzLTguMjU4MDY1LTQuOTU0ODM5LTE2LjUxNjEyOS04LjI1ODA2NS0yNC43NzQxOTMtMy4zMDMyMjYtOS45MDk2NzctNC45NTQ4MzktMTYuNTE2MTI5LTMuMzAzMjI1LTIxLjQ3MDk2OCAwLTQuOTU0ODM5IDEuNjUxNjEzLTkuOTA5Njc3IDQuOTU0ODM4LTEzLjIxMjkwMyAzLjMwMzIyNi0zLjMwMzIyNiA5LjkwOTY3Ny00Ljk1NDgzOSAxOC4xNjc3NDItNC45NTQ4MzkgMTEuNTYxMjkgMCAyMS40NzA5NjggOC4yNTgwNjUgMjQuNzc0MTk0IDIzLjEyMjU4MWw3OS4yNzc0MTkgMjUyLjY5Njc3NCA3Ny42MjU4MDctMjQ5LjM5MzU0OWMzLjMwMzIyNi05LjkwOTY3NyA2LjYwNjQ1Mi0xNi41MTYxMjkgOS45MDk2NzctMTkuODE5MzU1IDMuMzAzMjI2LTMuMzAzMjI2IDguMjU4MDY1LTYuNjA2NDUyIDE0Ljg2NDUxNi02LjYwNjQ1MXMxMS41NjEyOSAxLjY1MTYxMyAxNC44NjQ1MTYgNi42MDY0NTFjMy4zMDMyMjYgMy4zMDMyMjYgOC4yNTgwNjUgOS45MDk2NzcgOS45MDk2NzggMTkuODE5MzU1bDc5LjI3NzQxOSAyNDkuMzkzNTQ5TDY5My42Nzc0MTkgMzY2LjY1ODA2NWM0Ljk1NDgzOS0xNi41MTYxMjkgMTMuMjEyOTAzLTI0Ljc3NDE5NCAyNi40MjU4MDctMjQuNzc0MTk0IDguMjU4MDY1IDAgMTQuODY0NTE2IDEuNjUxNjEzIDE4LjE2Nzc0MiA0Ljk1NDgzOSAzLjMwMzIyNiAzLjMwMzIyNiA0Ljk1NDgzOSA4LjI1ODA2NSA0Ljk1NDgzOCAxMy4yMTI5MDMgMCA0Ljk1NDgzOS0xLjY1MTYxMyAxMS41NjEyOS00Ljk1NDgzOCAyMS40NzA5Njh6IiBmaWxsPSIjNEQ5N0ZGIiBwLWlkPSIxNDAyIj48L3BhdGg+PHBhdGggZD0iTTczMy4zMTYxMjkgMTYuNTE2MTI5aC0zLjMwMzIyNnYxMzIuMTI5MDMyYzAgMTYuNTE2MTI5IDguMjU4MDY1IDUyLjg1MTYxMyA1Ny44MDY0NTIgNTIuODUxNjEzaDEyNy4xNzQxOTNMNzMzLjMxNjEyOSAxNi41MTYxMjl6IiBmaWxsPSIjQTZDQkZGIiBwLWlkPSIxNDAzIj48L3BhdGg+PC9zdmc+"
        const val ZIP_SVG =
            "PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQ2MzIwNzc1NTk3IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjE1MTgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNODU4LjgzODcxIDE2LjUxNjEyOUg2MjEuMDA2NDUyYzQuOTU0ODM5IDAgOC4yNTgwNjUgMy4zMDMyMjYgOC4yNTgwNjQgOC4yNTgwNjV2MTYuNTE2MTI5YzAgNC45NTQ4MzktMy4zMDMyMjYgOC4yNTgwNjUtOC4yNTgwNjQgOC4yNTgwNjRoLTc5LjI3NzQyYy00Ljk1NDgzOSAwLTguMjU4MDY1LTMuMzAzMjI2LTguMjU4MDY0LTguMjU4MDY0di0xNi41MTYxMjljMC00Ljk1NDgzOSAzLjMwMzIyNi04LjI1ODA2NSA4LjI1ODA2NC04LjI1ODA2NUgxNjUuMTYxMjlDMTI4LjgyNTgwNiAxNi41MTYxMjkgOTkuMDk2Nzc0IDQ2LjI0NTE2MSA5OS4wOTY3NzQgODIuNTgwNjQ1djg1OC44Mzg3MWMwIDM2LjMzNTQ4NCAyOS43MjkwMzIgNjYuMDY0NTE2IDY2LjA2NDUxNiA2Ni4wNjQ1MTZoNjkzLjY3NzQyYzM2LjMzNTQ4NCAwIDY2LjA2NDUxNi0yOS43MjkwMzIgNjYuMDY0NTE2LTY2LjA2NDUxNlY4Mi41ODA2NDVjMC0zNi4zMzU0ODQtMjkuNzI5MDMyLTY2LjA2NDUxNi02Ni4wNjQ1MTYtNjYuMDY0NTE2ek0zOTguMDM4NzEgOTAuODM4NzFjMC00Ljk1NDgzOSAzLjMwMzIyNi04LjI1ODA2NSA4LjI1ODA2NC04LjI1ODA2NWg3OS4yNzc0MmM0Ljk1NDgzOSAwIDguMjU4MDY1IDMuMzAzMjI2IDguMjU4MDY0IDguMjU4MDY1djE2LjUxNjEyOWMwIDQuOTU0ODM5LTMuMzAzMjI2IDguMjU4MDY1LTguMjU4MDY0IDguMjU4MDY0aC03OS4yNzc0MmMtNC45NTQ4MzkgMC04LjI1ODA2NS0zLjMwMzIyNi04LjI1ODA2NC04LjI1ODA2NHYtMTYuNTE2MTI5eiBtMCA5OS4wOTY3NzRjMC00Ljk1NDgzOSAzLjMwMzIyNi04LjI1ODA2NSA4LjI1ODA2NC04LjI1ODA2NWg3OS4yNzc0MmM0Ljk1NDgzOSAwIDguMjU4MDY1IDMuMzAzMjI2IDguMjU4MDY0IDguMjU4MDY1djE2LjUxNjEyOWMwIDQuOTU0ODM5LTMuMzAzMjI2IDguMjU4MDY1LTguMjU4MDY0IDguMjU4MDY0aC03OS4yNzc0MmMtNC45NTQ4MzkgMC04LjI1ODA2NS0zLjMwMzIyNi04LjI1ODA2NC04LjI1ODA2NHYtMTYuNTE2MTI5eiBtMCAxMTUuNjEyOTAzYzAtNC45NTQ4MzkgMy4zMDMyMjYtOC4yNTgwNjUgOC4yNTgwNjQtOC4yNTgwNjRoNzkuMjc3NDJjNC45NTQ4MzkgMCA4LjI1ODA2NSAzLjMwMzIyNiA4LjI1ODA2NCA4LjI1ODA2NHYxNi41MTYxMjljMCA0Ljk1NDgzOS0zLjMwMzIyNiA4LjI1ODA2NS04LjI1ODA2NCA4LjI1ODA2NWgtNzkuMjc3NDJjLTQuOTU0ODM5IDAtOC4yNTgwNjUtMy4zMDMyMjYtOC4yNTgwNjQtOC4yNTgwNjV2LTE2LjUxNjEyOXogbTIzMS4yMjU4MDYgMjA2LjQ1MTYxM2MwIDY0LjQxMjkwMy01MS4yIDExNS42MTI5MDMtMTE1LjYxMjkwMyAxMTUuNjEyOTAzcy0xMTUuNjEyOTAzLTUxLjItMTE1LjYxMjkwMy0xMTUuNjEyOTAzdi0xMTUuNjEyOTAzaDIzMS4yMjU4MDZ2MTE1LjYxMjkwM3ogbTAtMjU2YzAgNC45NTQ4MzktMS42NTE2MTMgOC4yNTgwNjUtNC45NTQ4MzkgOC4yNTgwNjVoLTg1Ljg4Mzg3MWMtMy4zMDMyMjYgMC00Ljk1NDgzOS0zLjMwMzIyNi00Ljk1NDgzOC04LjI1ODA2NXYtMTYuNTE2MTI5YzAtNC45NTQ4MzkgMS42NTE2MTMtOC4yNTgwNjUgNC45NTQ4MzgtOC4yNTgwNjVoODUuODgzODcxYzMuMzAzMjI2IDAgNC45NTQ4MzkgMy4zMDMyMjYgNC45NTQ4MzkgOC4yNTgwNjV2MTYuNTE2MTI5eiBtMC0xMTUuNjEyOTAzYzAgNC45NTQ4MzktMy4zMDMyMjYgOC4yNTgwNjUtOC4yNTgwNjQgOC4yNTgwNjRoLTc5LjI3NzQyYy00Ljk1NDgzOSAwLTguMjU4MDY1LTMuMzAzMjI2LTguMjU4MDY0LTguMjU4MDY0di0xNi41MTYxMjljMC00Ljk1NDgzOSAzLjMwMzIyNi04LjI1ODA2NSA4LjI1ODA2NC04LjI1ODA2NWg3OS4yNzc0MmM0Ljk1NDgzOSAwIDguMjU4MDY1IDMuMzAzMjI2IDguMjU4MDY0IDguMjU4MDY1djE2LjUxNjEyOXoiIGZpbGw9IiNGRDhENTkiIHAtaWQ9IjE1MTkiPjwvcGF0aD48L3N2Zz4="
        const val EXCEL_SVG =
            "PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQ2MzIwNzg2MjgzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjE2MzQiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNzQ5LjgzMjI1OCAxNC44NjQ1MTZoLTU0NS4wMzIyNThjLTQ2LjI0NTE2MSAwLTgyLjU4MDY0NSAzNi4zMzU0ODQtODIuNTgwNjQ1IDgyLjU4MDY0NXY4MjUuODA2NDUyYzAgNDYuMjQ1MTYxIDM2LjMzNTQ4NCA4Mi41ODA2NDUgODIuNTgwNjQ1IDgyLjU4MDY0NWg2NDQuMTI5MDMyYzQ2LjI0NTE2MSAwIDgyLjU4MDY0NS0zNi4zMzU0ODQgODIuNTgwNjQ1LTgyLjU4MDY0NXYtNzI2LjcwOTY3OGwtMTgxLjY3NzQxOS0xODEuNjc3NDE5eiBtLTQ3Ljg5Njc3NCA2MzUuODcwOTY4YzkuOTA5Njc3IDkuOTA5Njc3IDkuOTA5Njc3IDI0Ljc3NDE5NCAwIDM0LjY4Mzg3MS05LjkwOTY3NyA5LjkwOTY3Ny0yNC43NzQxOTQgOS45MDk2NzctMzQuNjgzODcxIDBMNTI2Ljg2NDUxNiA1NDUuMDMyMjU4bC0xNDAuMzg3MDk3IDE0MC4zODcwOTdjLTkuOTA5Njc3IDkuOTA5Njc3LTI0Ljc3NDE5NCA5LjkwOTY3Ny0zNC42ODM4NzEgMC05LjkwOTY3Ny05LjkwOTY3Ny05LjkwOTY3Ny0yNC43NzQxOTQgMC0zNC42ODM4NzFsMTQwLjM4NzA5Ny0xNDAuMzg3MDk3LTE0MC4zODcwOTctMTQwLjM4NzA5N2MtOS45MDk2NzctOS45MDk2NzctOS45MDk2NzctMjQuNzc0MTk0IDAtMzQuNjgzODcxIDkuOTA5Njc3LTkuOTA5Njc3IDI0Ljc3NDE5NC05LjkwOTY3NyAzNC42ODM4NzEgMGwxNDAuMzg3MDk3IDE0MC4zODcwOTcgMTQwLjM4NzA5Ny0xNDAuMzg3MDk3YzkuOTA5Njc3LTkuOTA5Njc3IDI0Ljc3NDE5NC05LjkwOTY3NyAzNC42ODM4NzEgMCA5LjkwOTY3NyA5LjkwOTY3NyA5LjkwOTY3NyAyNC43NzQxOTQgMCAzNC42ODM4NzFMNTYxLjU0ODM4NyA1MTAuMzQ4Mzg3bDE0MC4zODcwOTcgMTQwLjM4NzA5N3oiIGZpbGw9IiM1OEMwMTIiIHAtaWQ9IjE2MzUiPjwvcGF0aD48cGF0aCBkPSJNNzQ2LjUyOTAzMiAxNC44NjQ1MTZINzQzLjIyNTgwNnYxMzIuMTI5MDMyYzAgMTYuNTE2MTI5IDguMjU4MDY1IDUyLjg1MTYxMyA1Ny44MDY0NTIgNTIuODUxNjEzaDEyNy4xNzQxOTRMNzQ2LjUyOTAzMiAxNC44NjQ1MTZ6IiBmaWxsPSIjQUNFMDg5IiBwLWlkPSIxNjM2Ij48L3BhdGg+PC9zdmc+"
        const val TEXT_SVG =
            "PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQ2MzIwNzk1NjY0IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjE3NTEiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNzQzLjIyNTgwNiAxNi41MTYxMjlIMTk4LjE5MzU0OEMxNTMuNiAxNi41MTYxMjkgMTE1LjYxMjkwMyA1NC41MDMyMjYgMTE1LjYxMjkwMyA5OS4wOTY3NzR2ODI1LjgwNjQ1MmMwIDQ2LjI0NTE2MSAzNi4zMzU0ODQgODIuNTgwNjQ1IDgyLjU4MDY0NSA4Mi41ODA2NDVoNjQ0LjEyOTAzM2M0Ni4yNDUxNjEgMCA4Mi41ODA2NDUtMzYuMzM1NDg0IDgyLjU4MDY0NS04Mi41ODA2NDVWMTk4LjE5MzU0OEw3NDMuMjI1ODA2IDE2LjUxNjEyOXogbS00OS41NDgzODcgMzYwLjA1MTYxM2gtMTQyLjAzODcwOXYyOTUuNjM4NzFjMCAxMy4yMTI5MDMtMTEuNTYxMjkgMjQuNzc0MTk0LTI0Ljc3NDE5NCAyNC43NzQxOTNzLTI0Ljc3NDE5NC0xMS41NjEyOS0yNC43NzQxOTMtMjQuNzc0MTkzVjM3Ni41Njc3NDJIMzQ2LjgzODcxYy0xMy4yMTI5MDMgMC0yNC43NzQxOTQtMTEuNTYxMjktMjQuNzc0MTk0LTI0Ljc3NDE5NHMxMS41NjEyOS0yNC43NzQxOTQgMjQuNzc0MTk0LTI0Ljc3NDE5M2gzNDYuODM4NzA5YzEzLjIxMjkwMyAwIDI0Ljc3NDE5NCAxMS41NjEyOSAyNC43NzQxOTQgMjQuNzc0MTkzcy0xMS41NjEyOSAyNC43NzQxOTQtMjQuNzc0MTk0IDI0Ljc3NDE5NHoiIGZpbGw9IiM5MUE3QjkiIHAtaWQ9IjE3NTIiPjwvcGF0aD48cGF0aCBkPSJNNzQ2LjUyOTAzMiAxNC44NjQ1MTZINzQzLjIyNTgwNnYxMzIuMTI5MDMyYzAgMTYuNTE2MTI5IDguMjU4MDY1IDUyLjg1MTYxMyA1Ny44MDY0NTIgNTIuODUxNjEzaDEyNy4xNzQxOTRMNzQ2LjUyOTAzMiAxNC44NjQ1MTZ6IiBmaWxsPSIjQzhEM0RDIiBwLWlkPSIxNzUzIj48L3BhdGg+PC9zdmc+"
        const val DIR_SVG =
            "PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjA2NzE0Nzc0MzI2IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjIyNzYiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNOTE3LjY2MTUzOCA5NDUuMjMwNzY5SDEwNi4zMzg0NjJBNjYuOTUzODQ2IDY2Ljk1Mzg0NiAwIDAgMSAzOS4zODQ2MTUgODc4LjI3NjkyM1YxNDkuNjYxNTM4QTcwLjg5MjMwOCA3MC44OTIzMDggMCAwIDEgMTEwLjI3NjkyMyA3OC43NjkyMzFoMzA4LjM4MTUzOWE5Mi4xNiA5Mi4xNiAwIDAgMSA3NC40MzY5MjMgMzkuMzg0NjE1bDUyLjM4MTUzOCA3MC44OTIzMDhhMTkuMjk4NDYyIDE5LjI5ODQ2MiAwIDAgMCAxNS4zNiA3Ljg3NjkyM2gzNTQuNDYxNTM5QTcwLjg5MjMwOCA3MC44OTIzMDggMCAwIDEgOTg0LjYxNTM4NSAyNjcuODE1Mzg1djYxMC40NjE1MzhhNjYuOTUzODQ2IDY2Ljk1Mzg0NiAwIDAgMS02Ni45NTM4NDcgNjYuOTUzODQ2eiIgZmlsbD0iI0ZGRDAzMSIgcC1pZD0iMjI3NyI+PC9wYXRoPjxwYXRoIGQ9Ik0xMTguMTUzODQ2IDI3NS42OTIzMDhtMzkuMzg0NjE2IDBsNzA4LjkyMzA3NiAwcTM5LjM4NDYxNSAwIDM5LjM4NDYxNiAzOS4zODQ2MTVsMCAwcTAgMzkuMzg0NjE1LTM5LjM4NDYxNiAzOS4zODQ2MTVsLTcwOC45MjMwNzYgMHEtMzkuMzg0NjE1IDAtMzkuMzg0NjE2LTM5LjM4NDYxNWwwIDBxMC0zOS4zODQ2MTUgMzkuMzg0NjE2LTM5LjM4NDYxNVoiIGZpbGw9IiNGRkZGRkYiIHAtaWQ9IjIyNzgiPjwvcGF0aD48L3N2Zz4="
    }
}